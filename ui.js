!function(){var t={exports:{}},e={exports:{}};function n(t,e){this.type=t,this.data=e}function r(t){return t.replace(/['\\]/g,(function(t){return"\\"+t})).replace(/\n/g,"\\n").replace(/\r/g,"\\r")}function i(t,e){if(!(this instanceof i))return new i(t,e);this.name=t,this.production=e}function s(t,e){if(!(this instanceof s))return new s(t,e);this.rules=t,this.start=e||t[0].name,this.symbolMap={},this.symbolsList=e?[e]:[],e&&(this.symbolMap[e]={rules:[]});for(var n=0;n<this.rules.length;++n){var r=this.rules[n].name;r in this.symbolMap||(this.symbolMap[r]={rules:[]},this.symbolsList.push(r));for(var i=0;i<this.rules[n].production.length;++i){var a=this.rules[n].production[i];"NT"!=a.type||a.data in this.symbolMap||(this.symbolMap[a.data]={rules:[]},this.symbolsList.push(a.data))}this.symbolMap[r].rules.push(this.rules[n])}}n.prototype.equals=function(t){return t.type===this.type&&t.data===this.data},n.prototype.toString=function(){return this.data.toString()},i.prototype.equals=function(t){if(t.name!==this.name)return!1;if(t.production.length!==this.production.length)return!1;for(var e=0;e<t.production.length;++e)if(!t.production[e].equals(this.production[e]))return!1;return!0},i.prototype.toString=function(){return this.name+" -> "+this.production.join("")},i.prototype.repr=function(){for(var t="Rule('"+r(this.name)+"', [",e=0;e<this.production.length;++e)e>0&&(t+=", "),t+=this.production[e].type+"('"+r(this.production[e].data)+"')";return t+="])"},s.prototype.repr=function(){for(var t="Grammar([\n  ",e=0;e<this.rules.length;++e)e>0&&(t+=",\n  "),t+=this.rules[e].repr();return t+="\n], '"+r(this.start)+"')"},s.prototype.getReverseMap=function(){if(!this.hasOwnProperty("_reverseMap")){this._reverseMap={};for(var t=0;t<this.symbolsList.length;++t)this._reverseMap[this.symbolsList[t]]=[];for(t=0;t<this.rules.length;++t)for(var e=this.rules[t],n=0;n<e.production.length;++n)"NT"===e.production[n].type&&this._reverseMap[e.production[n].data].push(e)}return this._reverseMap};var a={Sym:n,NT:function(t){return new n("NT",t)},T:function(t){return new n("T",t)},Rule:i,Grammar:s},o=function(t,e){if(!t)throw new Error(e)},l=o;function u(t){for(var e=0,n=0;n<t.length;++n)e+=t[n];return e}function h(t,e){var n=u(t);if(0==n)return-1;for(var r=0;r<t.length;++r){var i=t[r]/n;if(e<i)return r;e-=i}return console.log("No choices? This shouldn't really happen.",e),t.length-1}var p=function(t,e){if(!(t=t.deNulled()).empty&&t.annotateSelfDeriving().length>0)throw Error("Generator does not work when there are infinitely many parses for a string. (ie, when A*=>A is possible.)");var n,r=e?(n=49734321,function(){return(268435455&(n=4294967295&(3042594569^(n=4251993797+(n=4294967295&(3550635116+(n=374761393+(n=4294967295&(3345072700^(n=n+2127912214+(n<<12)&4294967295)^n>>>19))+(n<<5)&4294967295)^n<<9))+(n<<3)&4294967295)^n>>>16)))/268435456}):Math.random,i={};function s(e,n){if(e in i||(i[e]={}),n in i[e])return i[e][n];for(var r=[],s=0;s<t.symbolMap[e].rules.length;++s)r.push(u(o(e,s,0,n)));return i[e][n]=r,r}var a={};function o(e,n,r,i){if(0==i)return[];if(e in a||(a[e]={}),n in a[e]||(a[e][n]={}),r in a[e][n]||(a[e][n][r]={}),i in a[e][n][r])return a[e][n][r][i];var l,h=t.symbolMap[e].rules[n].production[r],p=t.symbolMap[e].rules[n].production.length-1;if("T"==h.type)l=r==p?1==i?[1]:[0]:[u(o(e,n,r+1,i-1))];else if(r==p)l=[u(s(h.data,i))];else{l=[];for(var c=1;c<=i-p+r;++c)l.push(u(s(h.data,c))*u(o(e,n,r+1,i-c)))}return a[e][n][r][i]=l,l}function p(t,e){var n=h(s(t,e),r());return-1==n?null:c(t,n,0,e)}function c(e,n,i,s){var a=t.symbolMap[e].rules[n].production[i],u=t.symbolMap[e].rules[n].production.length-1;if("T"==a.type)return i==u?[a.data]:[a.data].concat(c(e,n,i+1,s-1));if(i==u)return p(a.data,s);var f=h(o(e,n,i,s),r());return l(-1!==f,"Couldn't find a valid choice."),p(a.data,f+1).concat(c(e,n,i+1,s-(f+1)))}function f(e,n){var r=null!=n&&n.list;if(0==e)return t.makesEpsilon?r?[]:"":null;if(t.empty)return null;var i=p(t.start,e);return null==i?null:r?i:i.join("")}return f.findLength=function(e,n){if(t.empty)return t.makesEpsilon?-2:-3;if(n=n||10,0==(e=e||0)&&t.makesEpsilon)return 0;for(var i=e;i<e+n;++i)if(-1!==h(s(t.start,i),r()))return i;return-1},f.findLengths=function(e,n){if(e=e||0,n=n||10,t.empty)return t.makesEpsilon?0==e?[0]:[]:null;var i=[];0==e&&(t.makesEpsilon&&i.push(0),e=1);for(var a=e;a<e+n;++a)-1!==h(s(t.start,a),r())&&i.push(a);return i},f},f=a.Rule,d=o,m=o,v=a;!function(t){function e(t,e){for(var n=[],r=0,i=1;i<=e;++r,i<<=1)i&e&&n.push(t[r]);return n}t.prototype.annotateNullables=function(){if(this.hasOwnProperty("nullables"))return this.nullables;this.nullables=[];for(var t=[],e=[],n=this.getReverseMap(),r=0;r<this.symbolsList.length;++r)this.symbolMap[this.symbolsList[r]].nullable=!1;for(r=0;r<this.rules.length;++r){for(var i=0,s=this.rules[r],a=!0,o=0;o<s.production.length;++o){if("NT"!==s.production[o].type){a=!1;break}++i}a?e.push(i):e.push(0),0!=s.production.length||this.symbolMap[s.name].nullable||(this.symbolMap[s.name].nullable=!0,t.push(s.name),this.nullables.push(s.name))}for(r=0;r<this.rules.length;++r)this.rules[r]._index=r;for(;t.length>0;){var l=t.pop();for(r=0;r<n[l].length;++r){var u=n[l][r];0!=--e[u._index]||this.symbolMap[u.name].nullable||(this.symbolMap[u.name].nullable=!0,t.push(u.name),this.nullables.push(u.name))}}for(r=0;r<this.rules.length;++r)delete this.rules[r]._index;return this.nullables},t.prototype.annotateUnreachables=function(){if(this.hasOwnProperty("unreachables"))return this.unreachables;this.unreachables=[];for(var t=[this.start],e=0;e<this.symbolsList.length;++e)this.symbolMap[this.symbolsList[e]].unreachable=!0;for(this.symbolMap[this.start].unreachable=!1;t.length>0;)for(var n=t.pop(),r=0;r<this.symbolMap[n].rules.length;++r)for(var i=this.symbolMap[n].rules[r],s=0;s<i.production.length;++s){var a=i.production[s];"NT"===a.type&&this.symbolMap[a.data].unreachable&&(this.symbolMap[a.data].unreachable=!1,t.push(a.data))}for(e=0;e<this.symbolsList.length;++e)this.symbolMap[this.symbolsList[e]].unreachable&&this.unreachables.push(this.symbolsList[e]);return this.unreachables},t.prototype.annotateUseless=function(){if(this.hasOwnProperty("uselesses"))return this.uselesses;this.uselesses=[];for(var t=[],e=[],n=this.getReverseMap(),r=0;r<this.symbolsList.length;++r)this.symbolMap[this.symbolsList[r]].useless=!0;for(r=0;r<this.rules.length;++r){for(var i=0,s=this.rules[r],a=0;a<s.production.length;++a)"NT"===s.production[a].type&&++i;e.push(i),0==i&&this.symbolMap[s.name].useless&&(this.symbolMap[s.name].useless=!1,t.push(s.name))}for(r=0;r<this.rules.length;++r)this.rules[r]._index=r;for(;t.length>0;){var o=t.pop();for(r=0;r<n[o].length;++r){var l=n[o][r];0==--e[l._index]&&this.symbolMap[l.name].useless&&(this.symbolMap[l.name].useless=!1,t.push(l.name))}}for(r=0;r<this.symbolsList.length;++r)this.symbolMap[this.symbolsList[r]].useless&&this.uselesses.push(this.symbolsList[r]);for(r=0;r<this.rules.length;++r)delete this.rules[r]._index;return this.uselesses},t.prototype.annotateSelfDeriving=function(){if(this.hasOwnProperty("selfDerivings"))return this.selfDerivings;this.selfDerivings=[],this.annotateNullables();for(var t={},e=0;e<this.symbolsList.length;++e)t[this.symbolsList[e]]={};t:for(e=0;e<this.rules.length;++e){var n=this.rules[e].name,r=this.rules[e].production;if(0!=r.length){for(var i=0;i<r.length;++i)if("T"==r[i].type)continue t;if(1!=r.length){var s=null;for(i=0;i<r.length;++i)if(!this.symbolMap[r[i].data].nullable){if(null!==s)continue t;s=r[i].data}if(null!==s)t[n][s]=!0;else for(i=0;i<r.length;++i)t[n][r[i].data]=!0}else t[n][r[0].data]=!0}}for(e=0;e<this.symbolsList.length;++e)for(i=0;i<this.symbolsList.length;++i)for(var a=0;a<this.symbolsList.length;++a)t[this.symbolsList[e]][this.symbolsList[a]]&&t[this.symbolsList[a]][this.symbolsList[i]]&&(t[this.symbolsList[e]][this.symbolsList[i]]=!0);for(e=0;e<this.symbolsList.length;++e){var o=this.symbolsList[e];t[o][o]?(this.symbolMap[o].selfDeriving=!0,this.selfDerivings.push(o)):this.symbolMap[o].selfDeriving=!1}return this.selfDerivings},t.prototype.strippedUseless=function(){this.annotateUseless();for(var e=[],n=0;n<this.rules.length;++n){var r=this.rules[n];if(!this.symbolMap[r.name].useless){var i;for(i=0;i<r.production.length&&("NT"!=r.production[i].type||!this.symbolMap[r.production[i].data].useless);++i);i==r.production.length&&e.push(r)}}if(0==e.length)return{empty:!0};var s=t(e,this.start);return 0===s.symbolMap[s.start].rules.length?{empty:!0}:(d(0==s.annotateUseless().length,"Haven't actually eliminated all useless productions?"),s)},t.prototype.strippedUnreachable=function(){this.annotateUnreachables();for(var e=[],n=0;n<this.rules.length;++n){var r=this.rules[n];this.symbolMap[r.name].unreachable||e.push(r)}if(0==e.length)return{empty:!0};var i=t(e,this.start);return 0===i.symbolMap[i.start].rules.length?{empty:!0}:(d(0==i.annotateUnreachables().length,"Haven't actually eliminated all unreachable productions?"),i)},t.prototype.strippedUnitProductions=function(){var e=[],n=[],r=[];function i(t){(function(t){for(var e=0;e<n.length;++e)if(n[e].equals(t))return!0;for(e=0;e<r.length;++e)if(r[e].equals(t))return!0;return!1})(t)||r.push(t)}for(var s=0;s<this.rules.length;++s){1!==(a=this.rules[s]).production.length||"T"==a.production[0].type?e.push(a):i(a)}for(;r.length>0;){var a=r.pop();n.push(a);var o=a.production[0].data;if(o!==a.name)for(var l=0;l<this.symbolMap[o].rules.length;++l){var u=this.symbolMap[o].rules[l],h=f(a.name,u.production.slice(0));1!==h.production.length||"T"==h.production[0].type?e.push(h):i(h)}}return 0==e.length?{empty:!0}:t(e,this.start)},t.prototype.strippedDuplicates=function(){for(var e=[],n=0;n<this.rules.length;++n){var r,i=this.rules[n];for(r=0;r<e.length&&!e[r].equals(i);++r);r==e.length&&e.push(i)}return t(e,this.start)},t.prototype.stripped=function(){var t=this.strippedUnitProductions();return t.empty||(t=t.strippedUseless()).empty||(t=t.strippedUnreachable()).empty?t:(d(0==t.annotateUseless().length,"Suddenly there are more useless symbols?"),t=t.strippedDuplicates())},t.prototype.deNulled=function(){var n=this.stripped();if(n.empty)return n.makesEpsilon=!1,n;n.annotateNullables();var r=n.symbolMap[n.start].nullable;newRules=[];for(var i=0;i<n.rules.length;++i){var s=n.rules[i];if(0!=s.production.length){for(var a=[],o=0;o<s.production.length;++o)"NT"==s.production[o].type&&n.symbolMap[s.production[o].data].nullable&&a.push(o);if(0!=a.length){var l=a.length==s.production.length?1:0,u=Math.pow(2,a.length)-l;for(o=0;o<u;++o){for(var h=e(a,o),p=[],c=0;c<s.production.length;++c)-1==h.indexOf(c)&&p.push(s.production[c]);newRules.push(f(s.name,p))}}else newRules.push(s)}}return 0==newRules.length?{empty:!0,makesEpsilon:r}:(n=t(newRules,n.start),d(0==n.annotateNullables().length,"Having removed nullables, there are still nullables."),(n=n.stripped()).makesEpsilon=r,d(n.empty||0==n.annotateSelfDeriving().length,"Removing nullables and unit productions did not prevent self-deriving, somehow."),n)},t.prototype.alphabet=function(){var t=this.deNulled();if(t.empty)return"";var e=[];return t.rules.forEach((function(t){t.production.forEach((function(t){"T"===t.type&&-1===e.indexOf(t.data)&&e.push(t.data)}))})),e.sort().join("")}}(v.Grammar);var y={},g={},b={},C={},E={},x={},O={};function N(t,e,n,r){if(!(this instanceof N))return new N(t,e,n,r);this.rule=t,this.index=e,this.predecessor=n,this.backPointers=r||[],m(this.index==this.backPointers.length)}y.PRODUCEONE=E,y.PRODUCETWO=x,y.PRODUCEALL=O,y.PRODUCECOUNT=x,NT=v.NT,T=v.T,Rule=v.Rule,Grammar=v.Grammar,N.prototype.done=function(){return this.index===this.rule.production.length},N.prototype.compare=function(t){return this.rule===t.rule&&this.index===t.index&&this.predecessor===t.predecessor?function(t,e){if(t===e)return!0;if(null==t||null==e)return!1;if(t.length!=e.length)return!1;for(var n=0;n<t.length;++n)if(t[n]!==e[n])return!1;return!0}(this.backPointers,t.backPointers)?C:b:g},N.prototype.next=function(){return this.rule.production[this.index]},N.prototype.toString=function(){return"("+this.rule.name+" -> "+this.rule.production.slice(0,this.index).join("")+"*"+this.rule.production.slice(this.index).join("")+", "+this.predecessor.toString()+")"},y.parse=function(t,e,n){if("string"!=typeof e)throw Error("Can't parse non-string object "+typeof e);var r=y.PRODUCECOUNT;n&&(y.PRODUCECOUNT=n);for(var i=[],s=0;s<=e.length;++s)i.push([]);function a(t,e){for(var n=0,r=0;r<i[e].length;++r){var s=t.compare(i[e][r]);if(s==C||s==b&&y.PRODUCECOUNT==E)return!0;if(s==b&&y.PRODUCECOUNT==x&&++n>1)return!0}return!1}function o(t,n){if(t.next().equals(T(e[n]))){var r=t.backPointers.slice(0);r.push(null);var s=N(t.rule,t.index+1,t.predecessor,r);a(s,n+1)||i[n+1].push(s)}}function l(e,n){for(var r=e.next(),s=0;s<t.symbolMap[r.data].rules.length;++s){a(l=N(t.symbolMap[r.data].rules[s],0,n),n)||i[n].push(l)}for(s=0;s<i[n].length;++s){var o=i[n][s];if(o.rule.name===r.data&&o.predecessor===n&&o.done()){var l,u=e.backPointers.slice(0);u.push(o),a(l=N(e.rule,e.index+1,e.predecessor,u),n)||i[n].push(l)}}}function u(t,e){for(var n=NT(t.rule.name),r=0;r<i[t.predecessor].length;++r){var s=i[t.predecessor][r];if(!s.done()&&n.equals(s.next())){var o=s.backPointers.slice(0);o.push(t);var l=N(s.rule,s.index+1,s.predecessor,o);a(l,e)||i[e].push(l)}}}if(y.PRODUCECOUNT==O&&0!==t.annotateSelfDeriving().length)throw Error("Asked for all parses, but grammar can produce infinitely many parses for some string. Check grammar.annotateSelfDeriving() for specifics.");var h=t.start,p=Rule(["GAMMA"],[NT(h)]);for(i[0].push(N(p,0,0)),s=0;s<=e.length;++s)for(var c=0;c<i[s].length;++c){(d=i[s][c]).done()?u(d,s):"NT"==d.next().type?l(d,s):o(d,s)}var f=[];for(s=0;s<i[e.length].length;++s){var d;(d=i[e.length][s]).rule===p&&d.done()&&f.push(d)}return y.PRODUCECOUNT=r,f};var M=y,_={},P=o,U=M,w=p;_.locatableDifference=function(t,e,n,r,i,s){if(n=n||10,(r=r||20)<0||n<1)return!1;var a=U.PRODUCECOUNT;function o(t,e){return U.PRODUCECOUNT=a,{string:t,acceptedByFirst:e}}U.PRODUCECOUNT=U.PRODUCEONE;for(var l=w(t,i),u=w(e,i),h=0;h<r;++h){var p=l(h),c=u(h);if(null!==p||null!==c){if(null!==p&&null===c)return s||P(1===U.parse(t,p).length,'Generated a string "'+p+'" which did not parse.'),o(p,!0);if(null===p&&null!==c)return s||P(1===U.parse(e,c).length,'Generated a string "'+c+'" which did not parse.'),o(c,!1);for(var f=0;f<n;++f){if(p=l(h),1!==U.parse(e,p).length)return o(p,!0);if(c=u(h),1!==U.parse(t,c).length)return o(c,!1)}}}return U.PRODUCECOUNT=a,null};function D(t){var e=document.createElement("span");if(0==t.length)e.appendChild(document.createTextNode("ɛ"));else for(var n=0;n<t.length;++n)if("T"==t[n].type)e.appendChild(document.createTextNode(t[n].data));else{var r=document.createElement("span");r.className="cfg-symbol",r.appendChild(document.createTextNode(t[n].data)),e.appendChild(r)}return e}function L(t){var e=document.createElement("span");e.className="cfg-rule";var n=document.createElement("span");return n.className="cfg-symbol",n.appendChild(document.createTextNode(t.name)),e.appendChild(n),e.appendChild(document.createTextNode(" → ")),e.appendChild(D(t.production)),e}var R={subtreePrinter:function t(e,n){n|=0;for(var r="",i=0;i<n;++i)r+="  ";for(console.log(r+e.rule),r+="  ",i=0;i<e.backPointers.length;++i){var s=e.backPointers[i];null===s?console.log(r+e.rule.production[i].data):t(s,n+1)}},rewritePrinter:function(t){var e=[t];function n(t){for(var n="",r=0;r<e.length;++r)r==t?n+="*"+e[r].rule.name+"*":"string"==typeof e[r]?n+=e[r]:n+=e[r].rule.name;return n}for(var r=0;r<e.length;++r)if("string"!=typeof e[r]){var i=e[r],s=i.rule.toString()+"  |  ";s+=n(r)+"  |  ";for(var a=[],o=0;o<i.index;++o)"T"==i.rule.production[o].type?a.push(i.rule.production[o].data):a.push(i.backPointers[o]);e=e.slice(0,r).concat(a).concat(e.slice(r+1)),s+=n(-1),console.log(s),--r}},astPrinter:function(t,e,n,r){var i="function"==typeof r;return function t(s){if(e&&1===s.backPointers.length){var a=s.backPointers[0];return null===a?{type:"Terminal",value:s.rule.production[0].data}:t(a)}for(var o={type:i?r(s.rule):s.rule,children:[]},l=!(n&&s.backPointers.some((function(t){return null!==t}))),u=0;u<s.backPointers.length;++u){var h=s.backPointers[u];null===h?l&&o.children.push({type:"Terminal",value:s.rule.production[u].data}):o.children.push(t(h))}return o}(t.backPointers[0])},domPrinter:function(t){var e=[t];function n(t,n){("number"!=typeof n||n<0)&&(n=1);var r=document.createElement("span");c=r;for(var i=0;i<e.length;++i)if(i==t&&(c=document.createElement("span"),c.className="cfg-rewrite",r.appendChild(c)),i-t>=n&&(c=r),"string"==typeof e[i])c.appendChild(document.createTextNode(e[i]));else{var s=document.createElement("span");s.className="cfg-symbol",s.appendChild(document.createTextNode(e[i].rule.name)),c.appendChild(s)}return r}var r=document.createElement("table");r.className="cfg-derivations derivations",r.innerHTML="<thead><tr><th>Rule</th><th>Application</th><th>Result</th></tr></thead>";var i,s=document.createElement("tr"),a=document.createElement("td");(i=document.createElement("sp")).className="cfg-rule",i.innerHTML='Start → <span class="cfg-symbol">'+t.backPointers[0].rule.name+"</span>",a.appendChild(i),s.appendChild(a),a=document.createElement("td"),(i=document.createElement("span")).className="cfg-start",i.appendChild(document.createTextNode("Start")),a.appendChild(i),s.appendChild(a),e=[t.backPointers[0]],(a=document.createElement("td")).appendChild(n(-1)),s.appendChild(a),r.appendChild(s);for(var o=0;o<e.length;++o)if("string"!=typeof e[o]){var l=e[o];s=document.createElement("tr");(a=document.createElement("td")).appendChild(L(l.rule)),s.appendChild(a),(a=document.createElement("td")).appendChild(n(o)),s.appendChild(a);for(var u=[],h=0;h<l.index;++h)"T"==l.rule.production[h].type?u.push(l.rule.production[h].data):u.push(l.backPointers[h]);e=e.slice(0,o).concat(u).concat(e.slice(o+1)),(a=document.createElement("td")).appendChild(n(o,u.length)),s.appendChild(a),r.appendChild(s),--o}return r},domGrammarPrinter:function(t){var e,n,r=document.createElement("div"),i=document.createElement("span");i.innerHTML='Start symbol: <span class="cfg-symbol">'+(e=t.start,(n=document.createElement("div")).appendChild(document.createTextNode(e)),n.innerHTML+"</span>"),r.appendChild(i),r.appendChild(document.createElement("br"));for(var s=0;s<t.symbolsList.length;++s){var a=t.symbolsList[s];i=document.createElement("span");var o=document.createElement("span");o.className="cfg-symbol",o.appendChild(document.createTextNode(a)),i.appendChild(o),i.appendChild(document.createTextNode(" → "));for(var l=0;l<t.symbolMap[a].rules.length;++l){l>0&&i.appendChild(document.createTextNode(" | "));var u=t.symbolMap[a].rules[l];i.appendChild(D(u.production))}r.appendChild(i),r.appendChild(document.createElement("br"))}return r}};e.exports={types:a,generator:p,parser:M,checks:_,printers:R};var k={};function A(t,e,n,r){this.alphabet=t.slice(0),this.states=Object.getOwnPropertyNames(e).sort(),this.delta=e,this.initial=n,this.final=r.slice(0),this.isMinimized=!1}function q(t,e,n,r){this.alphabet=t.slice(0),this.states=Object.getOwnPropertyNames(e).sort(),this.delta=e,this.initial=n.slice(0),this.final=r.slice(0)}function S(t){return t.filter((function(t,e,n){return n.indexOf(t)==e})).sort()}function j(t){return t.replace(/["\\]/g,(function(t){return"\\"+t})).replace(/\n/g,"\\n").replace(/\r/g,"\\r")}function F(t,e,n,r){var i=r.state_fn||function(){},s=r.get_name||function(t){return t},a=r.should_exit||function(){return!1};if(a(e))return"";if("object"==typeof n){var o=n;n=function(t,e){return o[t][e]}}var l=Object.create(null);l[s(e)]="";for(var u=[e];u.length>0;){var h=u.shift(),p=s(h);i(h);for(var c=0;c<t.length;++c){var f=t[c],d=n(h,f),m=s(d);if(a(d))return l[h]+f;void 0===l[m]&&(l[m]=l[p]+f,u.push(d))}}return null}A.prototype.accepts=function(t){for(var e=this.initial,n=0;n<t.length;++n)e=this.delta[e][t[n]];return-1!==this.final.indexOf(e)},A.prototype.test=function(t){return this.accepts(t)},A.prototype.to_NFA=function(){for(var t={},e=0;e<this.states.length;++e){var n=this.states[e];t[n]={};for(var r=0;r<this.alphabet.length;++r)t[n][this.alphabet[r]]=[this.delta[n][this.alphabet[r]]]}return new q(this.alphabet,t,[this.initial],this.final)},A.prototype.minimized=function(){var t=this.to_NFA().reversed().to_DFA().to_NFA().reversed().to_DFA();return t.isMinimized=!0,t},A.prototype.without_unreachables=function(){var t={};F(this.alphabet,this.initial,this.delta,{state_fn:function(e){t[e]=!0}});for(var e={},n=Object.getOwnPropertyNames(t),r=0;r<n.length;++r)e[n[r]]=this.delta[n[r]];var i=this.final.filter(t.hasOwnProperty.bind(t));return new A(this.alphabet,e,this.initial,i)},A.prototype.complemented=function(){var t=this.final;return new A(this.alphabet,this.delta,this.initial,this.states.filter((function(e){return-1===t.indexOf(e)})))},A.prototype.find_passing=function(){return F(this.alphabet,this.initial,this.delta,{should_exit:function(t){return-1!==this.final.indexOf(t)}.bind(this)})},A.prototype.intersect=function(t){function e(e){return this.states.indexOf(e[0])+" "+t.states.indexOf(e[1])}e=e.bind(this);var n=[this.initial,t.initial],r=[],i={},s=this;return F(this.alphabet,n,(function(n,r){var a=[s.delta[n[0]][r],t.delta[n[1]][r]];return i[e(n)][r]=e(a),a}),{get_name:e,state_fn:function(n){var a=e(n);i[a]={},-1!==s.final.indexOf(n[0])&&-1!==t.final.indexOf(n[1])&&r.push(a)}}),new A(this.alphabet,i,e(n),r)},A.prototype.find_equivalence_counterexamples=function(t){return[this.intersect(t.complemented()).find_passing(),t.intersect(this.complemented()).find_passing()]},A.prototype.dottified=function(){var t='digraph foo {\n  rankdir=LR;\n  "__start" [style=invis label="" shape=plain];\n  node [shape=circle];',e=this;return this.states.filter((function(t){return-1==e.final.indexOf(t)})).forEach((function(e){t+=' "'+j(e)+'";'})),t+="\n  node [shape = doublecircle];",this.final.forEach((function(e){t+=' "'+j(e)+'";'})),t+='\n  "__start" -> "'+j(this.initial)+'";',this.states.forEach((function(n){var r={};e.states.forEach((function(t){r[t]=[]})),e.alphabet.forEach((function(t){r[e.delta[n][t]].push(t)})),e.states.forEach((function(e){0!==r[e].length&&(t+='\n  "'+j(n)+'" -> "'+j(e)+'" [label="'+r[e].map(j).join(",")+'"];')}))})),t+="\n}\n"},A.prototype.serialized=function(){var t=[];function e(e){return t.indexOf(e)}F(this.alphabet,this.initial,this.delta,{state_fn:function(e){t.push(e)}});for(var n=this.alphabet.slice(0).sort(),r="{",i=0;i<t.length;++i){0!==i&&(r+=", "),r+='"'+i+'": {';for(var s=0;s<n.length;++s){var a=n[s];0!==s&&(r+=", "),r+='"'+j(a)+'": "'+e(this.delta[t[i]][a])+'"'}r+="}"}r+="}";var o="{";return o+='"alphabet": ['+n.map(j).map((function(t){return'"'+t+'"'})).join(",")+"], ",o+='"delta": '+r+", ",o+='"initial": "'+e(this.initial)+'", ',o+='"final": ['+this.final.map(e).sort().map((function(t){return'"'+t+'"'})).join(",")+"]}"},q.prototype.epsilon_closure=function(t){for(var e=S(t),n=e.slice(0);n.length>0;){var r=n.pop(),i=this.delta[r][""];if(void 0!==i)for(var s=0;s<i.length;++s)-1===n.indexOf(i[s])&&-1===e.indexOf(i[s])&&(n.push(i[s]),e.push(i[s]))}return e},q.prototype.step=function(t,e){var n=this.delta;return 0===(t=t.map((function(t){var r=n[t][e];return void 0===r?[]:r}))).length?t:(t=t.reduce((function(t,e){return t.concat(e)})),this.epsilon_closure(t))},q.prototype.accepts=function(t){for(var e=this.epsilon_closure(this.initial),n=0;n<t.length;++n)e=this.step(e,t[n]);for(n=0;n<this.final.length;++n)if(-1!==e.indexOf(this.final[n]))return!0;return!1},q.prototype.test=function(t){return this.accepts(t)},q.prototype.to_DFA=function(){function t(t){return t.map(this.states.indexOf.bind(this.states)).sort().join(" ")}t=t.bind(this);var e=this.epsilon_closure(this.initial),n=[],r={},i=this;return F(this.alphabet,e,(function(e,n){var s=i.step(e,n);return r[t(e)][n]=t(s),s}),{get_name:t,state_fn:function(e){var s=t(e);r[s]={};for(var a=0;a<i.final.length;++a)if(-1!==e.indexOf(i.final[a])){n.push(s);break}}}),new A(this.alphabet,r,t(e),n)},q.prototype.minimized=function(){return this.to_DFA().minimized()},q.prototype.reversed=function(){for(var t={},e=0;e<this.states.length;++e)t[this.states[e]]={};for(e=0;e<this.states.length;++e)for(var n=this.states[e],r=0;r<=this.alphabet.length;++r){var i=r==this.alphabet.length?"":this.alphabet[r],s=this.delta[n][i];if(void 0!==s)for(var a=0;a<s.length;++a){var o=t[s[a]][i];t[s[a]][i]=void 0===o?[n]:S(o.concat([n]))}}return new q(this.alphabet,t,this.final,this.initial)},q.prototype._clone=function(t){function e(e){return""+t+this.states.indexOf(e)}e=e.bind(this);for(var n={},r=0;r<this.states.length;++r){var i=this.states[r],s=e(i);n[s]={};for(var a=0;a<=this.alphabet.length;++a){var o=a==this.alphabet.length?"":this.alphabet[a],l=this.delta[i][o];void 0!==l&&(n[s][o]=l.map(e))}}return new q(this.alphabet,n,this.initial.map(e),this.final.map(e))},q.prototype.concat=function(t){for(var e=this._clone("q"),n=t._clone("r"),r=0;r<n.states.length;++r){var i=n.states[r];e.delta[i]=n.delta[i]}for(r=0;r<e.final.length;++r){i=e.final[r];var s=e.delta[i][""];void 0===s&&(s=e.delta[i][""]=[]);for(var a=0;a<n.initial.length;++a)s.push(n.initial[a])}return new q(this.alphabet,e.delta,e.initial,n.final)},q.prototype.union=function(t){for(var e=this._clone("q"),n=t._clone("r"),r=0;r<n.states.length;++r){var i=n.states[r];e.delta[i]=n.delta[i]}return e.delta.s={"":e.initial.concat(n.initial)},new q(this.alphabet,e.delta,["s"],e.final.concat(n.final))},q.prototype.star=function(){var t=this._clone("q");t.delta.s={"":t.initial};for(var e=0;e<t.final.length;++e){var n=t.final[e],r=t.delta[n][""];void 0===r&&(r=t.delta[n][""]=[]),r.push("s")}return new q(t.alphabet,t.delta,["s"],["s"])},q.prototype.plus=function(){for(var t=this._clone("q"),e=0;e<t.final.length;++e){var n=t.final[e],r=t.delta[n][""];void 0===r&&(r=t.delta[n][""]=[]);for(var i=0;i<t.initial.length;++i)r.push(t.initial[i])}return t},q.prototype.repeat=function(t){if(t<0)throw"Can't repeat a negative number of times ("+t+")";return 0===t?q.for("",this.alphabet):1===t?this:this.concat(this.repeat(t-1))},q.prototype.optional=function(){var t=this._clone("q");return t.delta.s={"":t.initial},new q(t.alphabet,t.delta,["s"],t.final.concat(["s"]))},q.for=function(t,e){for(var n="s",r={s:{}},i=0;i<t.length;++i){var s="q"+(i+1);r[n][t[i]]=[s],r[s]={},n=s}return new q(e,r,["s"],[n])},q.prototype.dottified=function(){var t='digraph foo {\n  rankdir=LR;\n  "__start" [style=invis label="" shape=plain];\n  node [shape=circle];',e=this;return this.states.filter((function(t){return-1==e.final.indexOf(t)})).forEach((function(e){t+=' "'+j(e)+'";'})),t+="\n  node [shape = doublecircle];",this.final.forEach((function(e){t+=' "'+j(e)+'";'})),this.initial.forEach((function(e){t+='\n  "__start" -> "'+j(e)+'";'})),this.states.forEach((function(n){var r={};e.states.forEach((function(t){r[t]=[]})),e.alphabet.concat("").forEach((function(t){var i=e.delta[n][t];void 0!==i&&(""===t&&(t="_"),i.forEach((function(e){r[e].push(t)})))})),e.states.forEach((function(e){0!==r[e].length&&(t+='\n  "'+j(n)+'" -> "'+j(e)+'" [label="'+r[e].map(j).join(",")+'"];')}))})),t+="\n}\n"},k.NFA=q,k.DFA=A;var G=e.exports,z=k.NFA,H=G.printers.astPrinter,I=G.parser,{Grammar:B,Rule:W,NT:J,T:K}=G.types,Q=[W("U",[J("C"),K("|"),J("U")]),W("U",[K("|"),J("U")]),W("U",[]),W("U",[J("C")]),W("C",[J("O"),J("C")]),W("C",[J("O")]),W("O",[J("R"),K("?")]),W("O",[J("R")]),W("R",[J("A"),K("*")]),W("R",[J("A"),K("+")]),W("R",[J("A"),K("^"),J("I")]),W("R",[J("A")]),W("A",[K("("),J("U"),K(")")]),W("A",[J("L")]),W("I",[J("D")]),W("I",[J("I"),J("D")]),W("D",[K("0")]),W("D",[K("1")]),W("D",[K("2")]),W("D",[K("3")]),W("D",[K("4")]),W("D",[K("5")]),W("D",[K("6")]),W("D",[K("7")]),W("D",[K("8")]),W("D",[K("9")])];function V(t){switch(Q.indexOf(t)){case 0:return"Union";case 1:return"EmptyUnion";case 2:return"Empty";case 4:return"Concatenation";case 6:return"Option";case 8:return"Star";case 9:return"Plus";case 10:return"Repetition";case 12:return"Paren";case 15:return"Digits";default:throw"Unreachable: "+Q.indexOf(t)}}function X(t,e){var n=B(Q.concat(e.map((function(t){return W("L",[K(t)])}))),"U"),r=I.parse(n,t);if(1!==r.length)throw"Couldn't unambiguously parse: "+r.length;return H(r[0],!0,!0,V)}t.exports=function(t,e){function n(t){return"Digits"===t.type?n(t.children[0])+n(t.children[1]):t.value}return void 0===e?e=function(t){return t.replace(/[\|\*\+\^\?\(\)0-9]/g,"").split("").filter((function(t,e,n){return n.indexOf(t)===e})).sort()}(t):"string"==typeof e&&(e=e.split("")),function t(r){switch(r.type){case"Union":return t(r.children[0]).union(t(r.children[1]));case"EmptyUnion":case"Option":return t(r.children[0]).optional();case"Empty":return z.for("",e);case"Concatenation":return t(r.children[0]).concat(t(r.children[1]));case"Star":return t(r.children[0]).star();case"Plus":return t(r.children[0]).plus();case"Repetition":return t(r.children[0]).repeat(parseInt(n(r.children[1])));case"Paren":return t(r.children[0]);case"Terminal":return z.for(r.value,e);default:throw"Unreachable: "+r.type}}(X(t,e))},t.exports.parse=X;var Y=t.exports;function Z(t){return document.querySelector(t)}function $(t){t.style.display="inline"}function tt(t){try{return Y(t)}catch(t){return null}}function et(){Z("#equiv-div").style.display="none",Z("#error-div").style.display="none",Z("#unequiv-div").style.display="none",Z("#both-error").style.display="none",Z("#first-error").style.display="none",Z("#second-error").style.display="none",Z("#first-accept-div").style.display="none",Z("#second-accept-div").style.display="none";var t,e,n=tt(Z("#regex-1").value.replace(/\s/g,"")),r=tt(Z("#regex-2").value.replace(/\s/g,""));if(!n||!r)return $(Z("#error-div")),void $(Z(n||r?n?"#second-error":"#first-error":"#both-error"));n.alphabet=r.alphabet=(t=n.alphabet,e=r.alphabet,t.concat(e).filter((function(t,e,n){return n.indexOf(t)===e})).sort()),n=n.minimized(),r=r.minimized();var i=n.find_equivalence_counterexamples(r);null===i[0]&&null===i[1]?$(Z("#equiv-div")):($(Z("#unequiv-div")),null!==(i=i.map((function(t){return""===t?"[empty string]":t})))[0]&&($(Z("#first-accept-div")),Z("#first-accept-pre").textContent=i[0]),null!==i[1]&&($(Z("#second-accept-div")),Z("#second-accept-pre").textContent=i[1]))}addEventListener("load",(function(){Z("#regex-1").addEventListener("input",et),Z("#regex-2").addEventListener("input",et),et()}))}();
//# sourceMappingURL=ui.js.map
